At 0 do StartIrond();

At 5 do StartVisitmetaDataservice();

#At 6 do Break(message => Done - MAP Server and VisITMeta Dataservice started - Next - VisITMeta GUI and irondetect and ironloggui);

At 10 do StartVisitmetaGUI();

At 12 do DeviceIp(
	device => irondetect,
	ip-address => 10.0.0.6,
	mode => update,
	ifmap-user => irondetect,
	ifmap-pass => irondetect);

At 14 do StartIrondetect();

#At 15 do Break(message => Step 1a - Infrastructure self publish - DHCP);

At 16 do SelfPublish(
	service-type => dhcp-server,
	service-name => DHCP,
	service-port => 67,
	implementation-name => ISC DHCP Server,
	implementation-version => 0.1,
	device => irondhcp-dhcp-server,
	ip => 10.0.0.1,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);
	
At 18 do IronDhcpEntry(
	ip => 10.0.0.2,
	mac => aa:bb:cc:dd:ee:aa,
	discoverer => irondhcp-dhcp-server,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

At 20 do IronDhcpEntry(
	ip => 10.0.0.3,
	mac => aa:bb:cc:dd:ee:bb,
	discoverer => irondhcp-dhcp-server,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

At 22 do IronDhcpEntry(
	ip => 10.0.0.4,
	mac => aa:bb:cc:dd:ee:cc,
	discoverer => irondhcp-dhcp-server,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

#At 13 do IronDhcpEntry(
#	ip => 10.0.0.5,
#	mac => aa:bb:cc:dd:ee:dd,
#	discoverer => irondhcp-dhcp-server,
#	ifmap-user => irondhcp,
#	ifmap-pass => irondhcp);
	
At 24 do IronDhcpEntry(
	ip => 10.0.0.6,
	mac => aa:bb:cc:dd:ee:ee,
	discoverer => irondhcp-dhcp-server,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

#At 25 do Break(message => Step 1b - Infrastructure self publish - other components);
	
At 26 do SelfPublish(
	service-type => pdp,
	service-name => radius,
	service-port => 1812,
	implementation-name => FreeRADIUS,
	implementation-version => 3.0,
	device => freeradius-pdp,
	ip => 10.0.0.2,
	ifmap-user => irongenlog-freeradius,
	ifmap-pass => irongenlog-freeradius);
	
At 28 do SelfPublish(
	service-type => vulnerability scanner,
	service-name => openvas,
	service-port => 9390,
	implementation-name => OpenVAS,
	implementation-version => 8.0,
	device => openvas,
	ip => 10.0.0.3,
	ifmap-user => ironvas,
	ifmap-pass => ironvas);
		
#At 30 do SelfPublish(
#	service-type => network monitor,
#	service-name => snort,
#	service-port => 67,
#	implementation-name => Snort,
#	implementation-version => 0.1,
#	device => snort,
#	ip => 10.0.0.4,
#	ifmap-user => decomap-snort,
#	ifmap-pass => decomap-snort);

#At 32 do DeviceIp(
#	device => nmap,
#	ip-address => 10.0.0.5,
#	mode => update,
#	ifmap-user => ironnmap,
#	ifmap-pass => ironnmap);

#At 33 do Break(message => Step 2 - Service detection via req-for-investigation);

#At 34 do Break(message => Step 3 - Smartphone connects);

At 35 do IronDhcpEntry(
	ip => 10.0.0.20,
	mac => cc:bb:cc:dd:ee:aa,
	discoverer => irondhcp-dhcp-server,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

At 37 do InvestigationRequested(
	device => irondhcp-dhcp-server,
	mac => cc:bb:cc:dd:ee:aa,
	qualifier => nmap:openvas,
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

At 45 do IrongenlogFreeradiusConnect(
	access-request => ar:1,
	pdp => freeradius-pdp,
	ip => 10.0.0.20,
	mac => cc:bb:cc:dd:ee:aa,
	device => Google Nexus,
	role => user:finance,
	name => Clint,
	login-success => true,
	radius-service-name => radius,
	radius-service-type => pdp,
	radius-service-port => 1812,
	ifmap-user => irongenlog-freeradius,
	ifmap-pass => irongenlog-freeradius);

#At 46 do Break(message => Next - Smartphone is detected - initial information is published);

At 48 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.system.imei,
	feature-type => qualified,
	feature-value => 12345678-1234-1-12,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

#At 27 do SingleSmartphoneFeatureDetected(
#	device => Google Nexus,
#	access-request => ar:1,
#	feature-id => smartphone.system.ip,
#	feature-type => qualified,
#	feature-value => 10.0.0.20,
#	ifmap-user => ironcontrol,
#	ifmap-pass => ironcontrol);

At 50 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.firmwareversion,
	feature-type => qualified,
	feature-value => 7.0,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

#At 51 do Break(message => Next - Two Apps on Smartphone is detected);

At 52 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.app:0.name,
	feature-type => qualified,
	feature-value => BenignApp,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

At 54 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.app:0.installer,
	feature-type => qualified,
	feature-value => Some_Shady_App_Store,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);
	
At 56 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.app:0.permission.requested,
	feature-type => qualified,
	feature-value => READ_SMS,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

At 58 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.app:1.name,
	feature-type => qualified,
	feature-value => Google_Maps,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

At 60 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => smartphone.android.app:1.installer,
	feature-type => qualified,
	feature-value => Google_Play_Store,
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);

#At 61 do Break(message => Next - Open port on Smartphone is detected);

At 65 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => vulnerability-scan-result.vulnerability:0.Port,
	feature-type => qualified,
	feature-value => 22,
	ifmap-user => ironvas,
	ifmap-pass => ironvas);

At 67 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => vulnerability-scan-result.vulnerability:0.Name,
	feature-type => qualified,
	feature-value => OpenSSH Server v7.1,
	ifmap-user => ironvas,
	ifmap-pass => ironvas);

At 69 do SingleSmartphoneFeatureDetected(
	device => Google Nexus,
	access-request => ar:1,
	feature-id => vulnerability-scan-result.vulnerability:0.Cveidentifier,
	feature-type => qualified,
	feature-value => CVE-1234-5678,
	ifmap-user => ironvas,
	ifmap-pass => ironvas);

At 75 do Break(message => Next - Purge all data);

At 76 do PurgeMetadata(
	ifmap-user => ironcontrol,
	ifmap-pass => ironcontrol);
At 76 do PurgeMetadata(
	ifmap-user => irongenlog-freeradius,
	ifmap-pass => irongenlog-freeradius);
At 76 do PurgeMetadata(
	ifmap-user => decomap-snort,
	ifmap-pass => decomap-snort);
At 76 do PurgeMetadata(
	ifmap-user => ironnmap,
	ifmap-pass => ironnmap);
At 76 do PurgeMetadata(
	ifmap-user => ironvas,
	ifmap-pass => ironvas);
At 76 do PurgeMetadata(
	ifmap-user => irondhcp,
	ifmap-pass => irondhcp);

At 77 do Break(message => Agenda finished);
